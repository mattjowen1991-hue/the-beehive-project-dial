<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Trinary Dial — Mors Orbis</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <style>
    :root {
      --void-black: #050507;
      --shadow: #0a0a0f;
      --static: #1a1a22;
      --bone: #c8c4b8;
      --dread-red: #8b0000;
      --dread-glow: #ff2222;
      --blood: #4a0000;
      --ascended-gold: #c9a227;
      --ascended-glow: #ffd700;
      --ascended-white: #fffff0;
      --highlight: #00ff88;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--void-black);
      color: var(--bone);
      font-family: 'Crimson Text', Georgia, serif;
      min-height: 100vh;
      overflow-x: hidden;
      transition: background 1s ease;
    }

    body.dread-active {
      background: #030304;
    }

    body.ascended-active {
      background: #08080a;
    }

    body.calling {
      animation: screen-shake 0.1s infinite;
    }

    @keyframes screen-shake {
      0%, 100% { transform: translate(0); }
      25% { transform: translate(-2px, 2px); }
      50% { transform: translate(2px, -2px); }
      75% { transform: translate(-2px, -2px); }
    }

    /* Noise overlay */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
      z-index: 1000;
    }

    /* Layout */
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header */
    header {
      text-align: center;
      padding: 15px 0 25px;
    }

    h1 {
      font-family: 'Cinzel', serif;
      font-size: clamp(1.4rem, 4vw, 2rem);
      font-weight: 400;
      letter-spacing: 0.25em;
      text-transform: uppercase;
      margin-bottom: 5px;
      transition: color 1s ease, text-shadow 1s ease;
    }

    body.dread-active h1 {
      color: var(--dread-glow);
      text-shadow: 0 0 30px var(--dread-red);
    }

    body.ascended-active h1 {
      color: var(--ascended-glow);
      text-shadow: 0 0 30px var(--ascended-gold);
    }

    .subtitle {
      font-style: italic;
      color: var(--static);
      font-size: 0.9rem;
    }

    /* Mode Selection - Big Prominent Buttons */
    .mode-selection {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 25px;
    }

    .mode-btn {
      padding: 20px;
      border: 2px solid var(--static);
      background: var(--shadow);
      color: var(--bone);
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      letter-spacing: 0.1em;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      border-radius: 4px;
    }

    .mode-btn:hover {
      transform: translateY(-2px);
    }

    .mode-btn.dread:hover,
    .mode-btn.dread.active {
      border-color: var(--dread-red);
      background: linear-gradient(180deg, var(--blood) 0%, var(--shadow) 100%);
      color: var(--dread-glow);
      box-shadow: 0 0 20px rgba(139, 0, 0, 0.4);
    }

    .mode-btn.ascended:hover,
    .mode-btn.ascended.active {
      border-color: var(--ascended-gold);
      background: linear-gradient(180deg, rgba(201, 162, 39, 0.2) 0%, var(--shadow) 100%);
      color: var(--ascended-glow);
      box-shadow: 0 0 20px rgba(201, 162, 39, 0.3);
    }

    .mode-btn span {
      display: block;
      font-family: 'Crimson Text', serif;
      font-size: 0.8rem;
      font-style: italic;
      margin-top: 8px;
      opacity: 0.7;
    }

    /* Current Action Box - THE KEY INSTRUCTION */
    .current-action {
      background: linear-gradient(180deg, var(--shadow) 0%, var(--void-black) 100%);
      border: 2px solid var(--static);
      border-radius: 4px;
      padding: 20px;
      margin-bottom: 20px;
      text-align: center;
    }

    .action-phase {
      font-family: 'Cinzel', serif;
      font-size: 0.75rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--static);
      margin-bottom: 10px;
    }

    .action-instruction {
      font-size: 1.2rem;
      line-height: 1.5;
      margin-bottom: 15px;
    }

    .action-instruction strong {
      color: var(--highlight);
    }

    body.dread-active .action-instruction strong {
      color: var(--dread-glow);
    }

    body.ascended-active .action-instruction strong {
      color: var(--ascended-glow);
    }

    .action-hint {
      font-size: 0.85rem;
      color: var(--static);
      font-style: italic;
    }

    /* Progress Bar */
    .progress-section {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 15px;
      align-items: center;
      margin-bottom: 20px;
    }

    .progress-bar {
      height: 12px;
      background: var(--void-black);
      border: 1px solid var(--static);
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 6px;
    }

    body.dread-active .progress-fill {
      background: linear-gradient(90deg, var(--dread-red), var(--dread-glow));
    }

    body.ascended-active .progress-fill {
      background: linear-gradient(90deg, var(--ascended-gold), var(--ascended-glow));
    }

    .progress-fill.neutral {
      background: linear-gradient(90deg, var(--static), var(--bone));
    }

    .progress-label {
      font-family: 'Cinzel', serif;
      font-size: 0.8rem;
      color: var(--static);
      min-width: 80px;
      text-align: right;
    }

    /* Rotation Counter */
    .rotation-counter {
      display: none;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
      padding: 12px 20px;
      background: var(--shadow);
      border: 1px solid var(--static);
      border-radius: 4px;
    }

    .rotation-counter.visible {
      display: flex;
    }

    .rotation-label {
      font-family: 'Cinzel', serif;
      font-size: 0.8rem;
      letter-spacing: 0.1em;
      color: var(--static);
    }

    .rotation-dots {
      display: flex;
      gap: 10px;
    }

    .rotation-dot {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--void-black);
      border: 2px solid var(--static);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Cinzel', serif;
      font-size: 0.75rem;
      color: var(--static);
      transition: all 0.3s ease;
    }

    .rotation-dot.filled {
      transform: scale(1.15);
      animation: rotation-pulse 0.5s ease;
    }

    body.dread-active .rotation-dot.filled {
      background: var(--dread-red);
      border-color: var(--dread-glow);
      color: var(--dread-glow);
      box-shadow: 0 0 15px var(--dread-red);
    }

    body.ascended-active .rotation-dot.filled {
      background: rgba(201, 162, 39, 0.3);
      border-color: var(--ascended-glow);
      color: var(--ascended-glow);
      box-shadow: 0 0 15px var(--ascended-gold);
    }

    @keyframes rotation-pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1.15); }
    }

    /* The Dial Container */
    .dial-container {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 10px;
      margin-bottom: 20px;
    }

    .dial-wrapper {
      position: relative;
      width: 380px;
      height: 380px;
    }

    @media (max-width: 500px) {
      .dial-wrapper {
        width: 320px;
        height: 320px;
      }
    }

    /* The Dial SVG */
    .dial-svg {
      width: 100%;
      height: 100%;
      filter: drop-shadow(0 0 20px rgba(0,0,0,0.8));
      transition: filter 1s ease;
    }

    body.dread-active .dial-svg {
      filter: drop-shadow(0 0 30px rgba(139, 0, 0, 0.4));
    }

    body.ascended-active .dial-svg {
      filter: drop-shadow(0 0 30px rgba(201, 162, 39, 0.3));
    }

    /* Ring backgrounds */
    .outer-ring-bg {
      fill: #0d0d0d;
      stroke: #1a1a1a;
      stroke-width: 2;
      transition: all 0.3s ease;
    }

    .middle-ring-bg {
      fill: #111;
      stroke: #222;
      stroke-width: 1;
      transition: all 0.3s ease;
    }

    .inner-ring-bg {
      fill: #0a0a0a;
      stroke: #1a1a1a;
      stroke-width: 1;
      transition: all 0.3s ease;
    }

    /* Active ring highlight */
    .ring-highlight {
      fill: none;
      stroke: var(--highlight);
      stroke-width: 3;
      stroke-dasharray: 10 5;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      animation: dash-rotate 2s linear infinite;
    }

    @keyframes dash-rotate {
      to { stroke-dashoffset: -30; }
    }

    .ring-highlight.active {
      opacity: 1;
    }

    body.dread-active .ring-highlight.active {
      stroke: var(--dread-glow);
    }

    body.ascended-active .ring-highlight.active {
      stroke: var(--ascended-glow);
    }

    /* Glyphs */
    .glyph {
      font-family: 'Cinzel', serif;
      font-size: 12px;
      fill: #333;
      transition: fill 0.3s ease, font-size 0.3s ease;
    }

    .glyph.lit {
      fill: var(--bone);
    }

    .glyph.target {
      fill: var(--highlight);
      font-size: 16px;
      font-weight: bold;
    }

    body.dread-active .glyph.target {
      fill: var(--dread-glow);
      filter: drop-shadow(0 0 5px var(--dread-red));
    }

    body.ascended-active .glyph.target {
      fill: var(--ascended-glow);
      filter: drop-shadow(0 0 5px var(--ascended-gold));
    }

    /* Blood channels */
    .blood-channel {
      stroke: #1a1a1a;
      stroke-width: 2;
      fill: none;
      transition: stroke 0.5s ease;
    }

    .blood-channel.filled {
      stroke: var(--dread-red);
      filter: drop-shadow(0 0 3px var(--dread-red));
    }

    body.ascended-active .blood-channel.filled {
      stroke: var(--ascended-gold);
      filter: drop-shadow(0 0 3px var(--ascended-gold));
    }

    /* Center eye */
    .center-eye-outer {
      fill: var(--void-black);
      stroke: #222;
      stroke-width: 2;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .center-eye-inner {
      fill: #111;
      transition: fill 0.5s ease;
      pointer-events: none;
    }

    .center-eye-outer.clickable {
      stroke: var(--highlight);
      animation: pulse-ring 1s ease-in-out infinite;
    }

    body.dread-active .center-eye-outer.clickable {
      stroke: var(--dread-glow);
    }

    body.ascended-active .center-eye-outer.clickable {
      stroke: var(--ascended-glow);
    }

    @keyframes pulse-ring {
      0%, 100% { stroke-width: 2; }
      50% { stroke-width: 4; }
    }

    body.dread-active .center-eye-inner.active {
      fill: var(--dread-red);
    }

    body.ascended-active .center-eye-inner.active {
      fill: var(--ascended-gold);
    }

    /* Alignment marker */
    .alignment-marker {
      fill: var(--highlight);
      transition: fill 0.3s ease;
    }

    body.dread-active .alignment-marker {
      fill: var(--dread-glow);
    }

    body.ascended-active .alignment-marker {
      fill: var(--ascended-gold);
    }

    /* Target marker for middle ring */
    .target-marker {
      fill: none;
      stroke: var(--highlight);
      stroke-width: 2;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .target-marker.visible {
      opacity: 1;
      animation: target-pulse 1s ease-in-out infinite;
    }

    @keyframes target-pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; }
    }

    body.dread-active .target-marker {
      stroke: var(--dread-glow);
    }

    body.ascended-active .target-marker {
      stroke: var(--ascended-glow);
    }

    /* Interactive overlays */
    .ring-control {
      position: absolute;
      border-radius: 50%;
      cursor: grab;
      opacity: 0;
      transition: opacity 0.3s ease, background 0.3s ease;
    }

    .ring-control:active {
      cursor: grabbing;
    }

    .ring-control.active-ring {
      opacity: 1;
      background: radial-gradient(circle, rgba(0, 255, 136, 0.1) 0%, transparent 70%);
    }

    body.dread-active .ring-control.active-ring {
      background: radial-gradient(circle, rgba(255, 34, 34, 0.1) 0%, transparent 70%);
    }

    body.ascended-active .ring-control.active-ring {
      background: radial-gradient(circle, rgba(255, 215, 0, 0.1) 0%, transparent 70%);
    }

    .ring-control.outer {
      width: 380px;
      height: 380px;
      top: 0;
      left: 0;
    }

    .ring-control.middle {
      width: 280px;
      height: 280px;
      top: 50px;
      left: 50px;
    }

    .ring-control.inner {
      width: 120px;
      height: 120px;
      top: 130px;
      left: 130px;
      cursor: pointer;
    }

    @media (max-width: 500px) {
      .ring-control.outer {
        width: 320px;
        height: 320px;
      }
      .ring-control.middle {
        width: 236px;
        height: 236px;
        top: 42px;
        left: 42px;
      }
      .ring-control.inner {
        width: 100px;
        height: 100px;
        top: 110px;
        left: 110px;
      }
    }

    /* Press counter display */
    .press-counter {
      position: absolute;
      bottom: -35px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
    }

    .press-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #1a1a1a;
      border: 1px solid #333;
      transition: all 0.2s ease;
    }

    .press-dot.filled {
      background: var(--highlight);
      border-color: var(--highlight);
      transform: scale(1.2);
    }

    body.dread-active .press-dot.filled {
      background: var(--dread-glow);
      border-color: var(--dread-red);
      box-shadow: 0 0 8px var(--dread-red);
    }

    body.ascended-active .press-dot.filled {
      background: var(--ascended-glow);
      border-color: var(--ascended-gold);
      box-shadow: 0 0 8px var(--ascended-gold);
    }

    /* Message Log */
    .message-log {
      background: var(--shadow);
      border: 1px solid var(--static);
      border-radius: 4px;
      padding: 15px;
      max-height: 200px;
      overflow-y: auto;
    }

    .log-title {
      font-family: 'Cinzel', serif;
      font-size: 0.7rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--static);
      margin-bottom: 10px;
    }

    .log-entry {
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,0.03);
      font-size: 0.85rem;
      line-height: 1.4;
      animation: fade-in 0.3s ease;
    }

    @keyframes fade-in {
      from { opacity: 0; transform: translateY(-5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .log-entry:last-child {
      border-bottom: none;
    }

    .log-entry.system { color: var(--static); font-style: italic; }
    .log-entry.dread { color: var(--dread-glow); }
    .log-entry.ascended { color: var(--ascended-glow); }
    .log-entry.warning { color: #ff6b35; }
    .log-entry.danger { color: var(--dread-glow); text-shadow: 0 0 10px var(--dread-red); }
    .log-entry.holy { color: var(--ascended-glow); text-shadow: 0 0 10px var(--ascended-gold); }

    /* The Call overlay */
    .call-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1001;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
    }

    .call-overlay.active {
      opacity: 1;
      pointer-events: all;
    }

    .call-overlay.dread {
      background: radial-gradient(ellipse at center, rgba(139, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.99) 100%);
    }

    .call-overlay.ascended {
      background: radial-gradient(ellipse at center, rgba(255, 250, 230, 0.95) 0%, rgba(255, 215, 0, 0.3) 100%);
    }

    .call-message {
      font-family: 'Cinzel', serif;
      font-size: clamp(1.2rem, 4vw, 2rem);
      text-align: center;
      padding: 40px;
      max-width: 700px;
      line-height: 1.8;
    }

    .call-overlay.dread .call-message {
      color: var(--dread-glow);
      text-shadow: 0 0 30px var(--dread-red);
      animation: dread-text 0.3s ease-in-out infinite;
    }

    .call-overlay.ascended .call-message {
      color: #8b6914;
      text-shadow: 0 0 20px var(--ascended-glow);
    }

    @keyframes dread-text {
      0%, 100% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.01) rotate(-0.5deg); }
      75% { transform: scale(0.99) rotate(0.5deg); }
    }

    .dismiss-call {
      margin-top: 30px;
      padding: 15px 40px;
      border: 2px solid currentColor;
      background: rgba(0,0,0,0.3);
      color: inherit;
      font-family: 'Cinzel', serif;
      font-size: 1rem;
      letter-spacing: 0.1em;
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 4px;
    }

    .dismiss-call:hover {
      background: rgba(255,255,255,0.2);
      transform: scale(1.05);
    }

    /* Reset button */
    .reset-btn {
      display: block;
      width: 100%;
      max-width: 200px;
      margin: 20px auto 0;
      padding: 12px 20px;
      border: 1px solid var(--static);
      background: transparent;
      color: var(--bone);
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      letter-spacing: 0.1em;
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 4px;
    }

    .reset-btn:hover {
      background: var(--shadow);
      border-color: var(--bone);
    }

    /* Direction indicator */
    .direction-hint {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .direction-hint.visible {
      opacity: 1;
    }

    .direction-hint svg {
      width: 60px;
      height: 60px;
      animation: rotate-hint 3s linear infinite;
    }

    .direction-hint.clockwise svg {
      animation-direction: normal;
    }

    .direction-hint.counter-clockwise svg {
      animation-direction: reverse;
    }

    @keyframes rotate-hint {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .direction-hint svg path {
      fill: none;
      stroke: var(--highlight);
      stroke-width: 3;
      stroke-linecap: round;
    }

    body.dread-active .direction-hint svg path {
      stroke: var(--dread-glow);
    }

    body.ascended-active .direction-hint svg path {
      stroke: var(--ascended-glow);
    }

    /* Scrollbar */
    .message-log::-webkit-scrollbar { width: 5px; }
    .message-log::-webkit-scrollbar-track { background: var(--void-black); }
    .message-log::-webkit-scrollbar-thumb { background: var(--static); border-radius: 3px; }
  </style>
</head>
<body>
  <div class="call-overlay" id="callOverlay">
    <div class="call-message" id="callMessage"></div>
    <button class="dismiss-call" onclick="dismissCall()">⛧ Sever Connection ⛧</button>
  </div>

  <div class="container">
    <header>
      <h1>The Trinary Dial</h1>
      <p class="subtitle">Mors Orbis — "The Death Disk"</p>
    </header>

    <!-- Mode Selection -->
    <div class="mode-selection">
      <button class="mode-btn dread" onclick="setMode('dread')">
        ⛧ Call The Dread
        <span>Chaos • Blood • Destruction</span>
      </button>
      <button class="mode-btn ascended" onclick="setMode('ascended')">
        ✦ Call The Others
        <span>Order • Light • Transcendence</span>
      </button>
    </div>

    <!-- Current Action - THE MAIN INSTRUCTION -->
    <div class="current-action">
      <div class="action-phase" id="actionPhase">— Awaiting Activation —</div>
      <div class="action-instruction" id="actionInstruction">
        Choose a ritual above to begin the summoning.
      </div>
      <div class="action-hint" id="actionHint">
        Select your path wisely. There is always a cost.
      </div>
    </div>

    <!-- Progress -->
    <div class="progress-section">
      <div class="progress-bar">
        <div class="progress-fill neutral" id="progressFill"></div>
      </div>
      <div class="progress-label" id="progressLabel">0%</div>
    </div>

    <!-- Rotation Counter (visible during Phase 1) -->
    <div class="rotation-counter" id="rotationCounter">
      <span class="rotation-label">Rotations:</span>
      <div class="rotation-dots">
        <div class="rotation-dot" id="rot1">I</div>
        <div class="rotation-dot" id="rot2">II</div>
        <div class="rotation-dot" id="rot3">III</div>
      </div>
    </div>

    <!-- The Dial -->
    <div class="dial-container">
      <div class="dial-wrapper">
        <svg class="dial-svg" viewBox="0 0 380 380" id="dialSvg">
          <defs>
            <filter id="glow">
              <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
              <feMerge>
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>

          <!-- Outer Ring -->
          <g id="outerRing">
            <circle class="outer-ring-bg" cx="190" cy="190" r="175" stroke-width="40"/>
            <circle class="ring-highlight" id="outerHighlight" cx="190" cy="190" r="175" stroke-width="42"/>
            
            <!-- Blood/Light channels -->
            <g class="channels">
              <path class="blood-channel" id="channel1" d="M 190 25 Q 200 40 190 55"/>
              <path class="blood-channel" id="channel2" d="M 310 70 Q 295 85 285 100"/>
              <path class="blood-channel" id="channel3" d="M 355 190 Q 340 195 325 190"/>
              <path class="blood-channel" id="channel4" d="M 310 310 Q 295 295 285 280"/>
              <path class="blood-channel" id="channel5" d="M 190 355 Q 180 340 190 325"/>
              <path class="blood-channel" id="channel6" d="M 70 310 Q 85 295 95 280"/>
              <path class="blood-channel" id="channel7" d="M 25 190 Q 40 185 55 190"/>
              <path class="blood-channel" id="channel8" d="M 70 70 Q 85 85 95 100"/>
            </g>

            <!-- Outer glyphs -->
            <text class="glyph" id="glyph-A" x="190" y="35" text-anchor="middle">A</text>
            <text class="glyph" id="glyph-B" x="295" y="85" text-anchor="middle">B</text>
            <text class="glyph" id="glyph-F" x="345" y="195" text-anchor="middle">F</text>
            <text class="glyph" id="glyph-G" x="295" y="305" text-anchor="middle">G</text>
            <text class="glyph" id="glyph-H" x="190" y="355" text-anchor="middle">H</text>
            <text class="glyph" id="glyph-I" x="85" y="305" text-anchor="middle">I</text>
            <text class="glyph" id="glyph-J" x="35" y="195" text-anchor="middle">J</text>
            <text class="glyph" id="glyph-K" x="85" y="85" text-anchor="middle">K</text>
            <text class="glyph" id="glyph-L" x="145" y="45" text-anchor="middle">L</text>
          </g>

          <!-- Middle Ring -->
          <g id="middleRing">
            <circle class="middle-ring-bg" cx="190" cy="190" r="125" stroke-width="35"/>
            <circle class="ring-highlight" id="middleHighlight" cx="190" cy="190" r="125" stroke-width="37"/>
            
            <!-- Middle glyphs -->
            <text class="glyph" id="glyph-C" x="190" y="78" text-anchor="middle">C</text>
            <text class="glyph" id="glyph-E" x="270" y="120" text-anchor="middle">E</text>
            <text class="glyph" id="glyph-M" x="302" y="195" text-anchor="middle">M</text>
            <text class="glyph" id="glyph-N" x="270" y="270" text-anchor="middle">N</text>
            <text class="glyph" id="glyph-O" x="190" y="310" text-anchor="middle">O</text>
            <text class="glyph" id="glyph-P" x="110" y="270" text-anchor="middle">P</text>
            <text class="glyph" id="glyph-Q" x="78" y="195" text-anchor="middle">Q</text>
            <text class="glyph" id="glyph-R" x="110" y="120" text-anchor="middle">R</text>
            <text class="glyph" id="glyph-S" x="150" y="78" text-anchor="middle">S</text>
          </g>

          <!-- Inner Ring -->
          <g id="innerRing">
            <circle class="inner-ring-bg" cx="190" cy="190" r="70" stroke-width="30"/>
            <circle class="ring-highlight" id="innerHighlight" cx="190" cy="190" r="70" stroke-width="32"/>
            
            <!-- Inner glyphs -->
            <text class="glyph" x="190" y="132" text-anchor="middle" font-size="10">D</text>
            <text class="glyph" x="230" y="155" text-anchor="middle" font-size="10">T</text>
            <text class="glyph" x="248" y="195" text-anchor="middle" font-size="10">U</text>
            <text class="glyph" x="230" y="235" text-anchor="middle" font-size="10">V</text>
            <text class="glyph" x="190" y="255" text-anchor="middle" font-size="10">W</text>
            <text class="glyph" x="150" y="235" text-anchor="middle" font-size="10">X</text>
            <text class="glyph" x="132" y="195" text-anchor="middle" font-size="10">Y</text>
            <text class="glyph" x="150" y="155" text-anchor="middle" font-size="10">Z</text>
            <text class="glyph" x="170" y="132" text-anchor="middle" font-size="10">Ω</text>
          </g>

          <!-- Target marker for phase 2 -->
          <circle class="target-marker" id="targetMarker" cx="190" cy="15" r="15"/>

          <!-- Alignment marker at top -->
          <polygon class="alignment-marker" points="190,5 185,18 195,18"/>

          <!-- Center Eye (clickable in phase 3) -->
          <circle class="center-eye-outer" id="centerEye" cx="190" cy="190" r="35"/>
          <circle class="center-eye-inner" id="centerEyeInner" cx="190" cy="190" r="15"/>
        </svg>

        <!-- Direction hint overlay -->
        <div class="direction-hint" id="directionHint">
          <svg viewBox="0 0 60 60">
            <path d="M 30 5 A 25 25 0 1 1 29 5" />
            <path d="M 25 10 L 30 3 L 35 10" />
          </svg>
        </div>

        <!-- Interactive ring controls -->
        <div class="ring-control outer" id="outerControl"></div>
        <div class="ring-control middle" id="middleControl"></div>
        <div class="ring-control inner" id="innerControl"></div>

        <!-- Press counter -->
        <div class="press-counter" id="pressCounter">
          <div class="press-dot" id="press1"></div>
          <div class="press-dot" id="press2"></div>
          <div class="press-dot" id="press3"></div>
          <div class="press-dot" id="press4"></div>
          <div class="press-dot" id="press5"></div>
          <div class="press-dot" id="press6"></div>
          <div class="press-dot" id="press7"></div>
          <div class="press-dot" id="press8"></div>
          <div class="press-dot" id="press9"></div>
        </div>
      </div>
    </div>

    <!-- Message Log -->
    <div class="message-log" id="messageLog">
      <div class="log-title">Manifestation Chronicle</div>
      <div id="logEntries">
        <div class="log-entry system">The dial lies dormant beneath centuries of silence...</div>
      </div>
    </div>

    <button class="reset-btn" onclick="resetDial()">↺ Reset Ritual</button>
  </div>

  <script>
    // State
    let mode = null;
    let phase = 0;
    let outerRotation = 0;
    let middleRotation = 0;
    let pressCount = 0;
    let progress = 0;
    let channelsFilled = 0;
    let isLocked = false;
    let rotationCount = 0; // Track completed rotations
    let lastRotationMilestone = 0; // Track when we last played a sound

    // Audio
    let audioCtx = null;

    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
    }

    function playSound(type) {
      initAudio();
      
      if (type === 'bone-crack') {
        // Layered bone cracking sound - multiple oscillators for texture
        const t = audioCtx.currentTime;
        
        // Low crunch
        const osc1 = audioCtx.createOscillator();
        const gain1 = audioCtx.createGain();
        osc1.type = 'sawtooth';
        osc1.frequency.setValueAtTime(80, t);
        osc1.frequency.exponentialRampToValueAtTime(20, t + 0.08);
        gain1.gain.setValueAtTime(0.4, t);
        gain1.gain.exponentialRampToValueAtTime(0.01, t + 0.1);
        osc1.connect(gain1);
        gain1.connect(audioCtx.destination);
        osc1.start(t);
        osc1.stop(t + 0.1);
        
        // Mid crack
        const osc2 = audioCtx.createOscillator();
        const gain2 = audioCtx.createGain();
        osc2.type = 'square';
        osc2.frequency.setValueAtTime(150, t + 0.02);
        osc2.frequency.exponentialRampToValueAtTime(40, t + 0.1);
        gain2.gain.setValueAtTime(0.3, t + 0.02);
        gain2.gain.exponentialRampToValueAtTime(0.01, t + 0.12);
        osc2.connect(gain2);
        gain2.connect(audioCtx.destination);
        osc2.start(t + 0.02);
        osc2.stop(t + 0.12);
        
        // High snap
        const osc3 = audioCtx.createOscillator();
        const gain3 = audioCtx.createGain();
        osc3.type = 'sawtooth';
        osc3.frequency.setValueAtTime(400, t + 0.01);
        osc3.frequency.exponentialRampToValueAtTime(100, t + 0.05);
        gain3.gain.setValueAtTime(0.2, t + 0.01);
        gain3.gain.exponentialRampToValueAtTime(0.01, t + 0.06);
        osc3.connect(gain3);
        gain3.connect(audioCtx.destination);
        osc3.start(t + 0.01);
        osc3.stop(t + 0.06);
        
        // Noise burst for texture
        const bufferSize = audioCtx.sampleRate * 0.1;
        const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) {
          data[i] = (Math.random() * 2 - 1) * Math.exp(-i / (bufferSize * 0.1));
        }
        const noise = audioCtx.createBufferSource();
        const noiseGain = audioCtx.createGain();
        noise.buffer = buffer;
        noiseGain.gain.setValueAtTime(0.15, t);
        noiseGain.gain.exponentialRampToValueAtTime(0.01, t + 0.1);
        noise.connect(noiseGain);
        noiseGain.connect(audioCtx.destination);
        noise.start(t);
        
        return;
      }
      
      if (type === 'chime') {
        // Crystal chime - multiple harmonics for bell-like sound
        const t = audioCtx.currentTime;
        const baseFreq = 800 + Math.random() * 100; // Slight variation each time
        
        // Fundamental
        const osc1 = audioCtx.createOscillator();
        const gain1 = audioCtx.createGain();
        osc1.type = 'sine';
        osc1.frequency.setValueAtTime(baseFreq, t);
        gain1.gain.setValueAtTime(0.25, t);
        gain1.gain.exponentialRampToValueAtTime(0.01, t + 0.8);
        osc1.connect(gain1);
        gain1.connect(audioCtx.destination);
        osc1.start(t);
        osc1.stop(t + 0.8);
        
        // Second harmonic
        const osc2 = audioCtx.createOscillator();
        const gain2 = audioCtx.createGain();
        osc2.type = 'sine';
        osc2.frequency.setValueAtTime(baseFreq * 2, t);
        gain2.gain.setValueAtTime(0.15, t);
        gain2.gain.exponentialRampToValueAtTime(0.01, t + 0.6);
        osc2.connect(gain2);
        gain2.connect(audioCtx.destination);
        osc2.start(t);
        osc2.stop(t + 0.6);
        
        // Third harmonic
        const osc3 = audioCtx.createOscillator();
        const gain3 = audioCtx.createGain();
        osc3.type = 'sine';
        osc3.frequency.setValueAtTime(baseFreq * 3, t);
        gain3.gain.setValueAtTime(0.1, t);
        gain3.gain.exponentialRampToValueAtTime(0.01, t + 0.4);
        osc3.connect(gain3);
        gain3.connect(audioCtx.destination);
        osc3.start(t);
        osc3.stop(t + 0.4);
        
        // High shimmer
        const osc4 = audioCtx.createOscillator();
        const gain4 = audioCtx.createGain();
        osc4.type = 'sine';
        osc4.frequency.setValueAtTime(baseFreq * 5.5, t);
        gain4.gain.setValueAtTime(0.05, t);
        gain4.gain.exponentialRampToValueAtTime(0.01, t + 0.3);
        osc4.connect(gain4);
        gain4.connect(audioCtx.destination);
        osc4.start(t);
        osc4.stop(t + 0.3);
        
        return;
      }

      // Original sounds for other effects
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);

      if (type === 'snap-dread') {
        osc.type = 'sawtooth';
        osc.frequency.setValueAtTime(60, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(30, audioCtx.currentTime + 0.15);
        gain.gain.setValueAtTime(0.4, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
      } else if (type === 'snap-ascended') {
        osc.type = 'sine';
        osc.frequency.setValueAtTime(600, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.15);
        gain.gain.setValueAtTime(0.25, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
      } else if (type === 'press-dread') {
        osc.type = 'square';
        osc.frequency.setValueAtTime(40 + pressCount * 8, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.25);
      } else if (type === 'press-ascended') {
        osc.type = 'triangle';
        osc.frequency.setValueAtTime(300 + pressCount * 60, audioCtx.currentTime);
        gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.35);
      } else if (type === 'complete') {
        osc.type = mode === 'dread' ? 'sawtooth' : 'sine';
        osc.frequency.setValueAtTime(mode === 'dread' ? 80 : 400, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(mode === 'dread' ? 20 : 800, audioCtx.currentTime + 0.5);
        gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.6);
      }

      osc.start(audioCtx.currentTime);
      osc.stop(audioCtx.currentTime + 0.6);
    }

    // Mode selection
    function setMode(newMode) {
      mode = newMode;
      phase = 1;
      progress = 0;
      pressCount = 0;
      channelsFilled = 0;
      outerRotation = 0;
      middleRotation = 0;
      isLocked = false;

      // Update UI
      document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`.mode-btn.${mode}`).classList.add('active');
      document.body.classList.remove('dread-active', 'ascended-active', 'calling');
      document.body.classList.add(`${mode}-active`);
      document.getElementById('progressFill').classList.remove('neutral');

      // Reset visuals
      document.getElementById('outerRing').setAttribute('transform', 'rotate(0, 190, 190)');
      document.getElementById('middleRing').setAttribute('transform', 'rotate(0, 190, 190)');
      document.querySelectorAll('.blood-channel').forEach(ch => ch.classList.remove('filled'));
      document.querySelectorAll('.glyph').forEach(g => g.classList.remove('lit', 'target'));
      clearPresses();
      
      // Reset rotation tracking
      rotationCount = 0;
      lastRotationMilestone = 0;
      
      // Reset rotation indicator dots
      document.querySelectorAll('.rotation-dot').forEach(dot => dot.classList.remove('filled'));

      // Set phase 1
      updateUI();
      addLog(mode === 'dread' 
        ? 'The temperature drops. Shadows gather at the edges of your vision.' 
        : 'The air shimmers with potential. Light begins to gather.', mode);
    }

    function updateUI() {
      const phaseEl = document.getElementById('actionPhase');
      const instructEl = document.getElementById('actionInstruction');
      const hintEl = document.getElementById('actionHint');

      // Highlight active ring
      document.querySelectorAll('.ring-highlight').forEach(h => h.classList.remove('active'));
      document.querySelectorAll('.ring-control').forEach(c => c.classList.remove('active-ring'));
      document.getElementById('centerEye').classList.remove('clickable');
      document.getElementById('centerEyeInner').classList.remove('active');
      document.getElementById('targetMarker').classList.remove('visible');
      document.getElementById('directionHint').classList.remove('visible', 'clockwise', 'counter-clockwise');
      document.getElementById('rotationCounter').classList.remove('visible');

      if (!mode) {
        phaseEl.textContent = '— Awaiting Activation —';
        instructEl.innerHTML = 'Choose a ritual above to begin the summoning.';
        hintEl.textContent = 'Select your path wisely. There is always a cost.';
        return;
      }

      if (phase === 1) {
        phaseEl.textContent = 'Phase 1: THE PRIME';
        document.getElementById('outerHighlight').classList.add('active');
        document.getElementById('outerControl').classList.add('active-ring');
        document.getElementById('rotationCounter').classList.add('visible');
        
        const direction = mode === 'dread' ? 'COUNTER-CLOCKWISE' : 'CLOCKWISE';
        const dirClass = mode === 'dread' ? 'counter-clockwise' : 'clockwise';
        instructEl.innerHTML = `<strong>Drag the OUTER RING ${direction}</strong>`;
        hintEl.textContent = 'Complete 3 full rotations. Each rotation seals the covenant.';
        
        document.getElementById('directionHint').classList.add('visible', dirClass);
        
      } else if (phase === 2) {
        phaseEl.textContent = 'Phase 2: THE TUNE';
        document.getElementById('middleHighlight').classList.add('active');
        document.getElementById('middleControl').classList.add('active-ring');
        document.getElementById('targetMarker').classList.add('visible');
        
        const targetGlyph = mode === 'dread' ? 'P' : 'S';
        document.getElementById(`glyph-${targetGlyph}`).classList.add('target');
        
        instructEl.innerHTML = `<strong>Spin the MIDDLE RING</strong> — align glyph <strong>"${targetGlyph}"</strong> with the marker at TOP`;
        hintEl.textContent = mode === 'dread' 
          ? 'The 6th Chaos Hexagon. Wrong alignment causes spontaneous combustion.'
          : 'The 9th Order Hexagon. Fear or ego will erase your mind.';
          
      } else if (phase === 3) {
        phaseEl.textContent = 'Phase 3: THE PIERCE';
        document.getElementById('innerHighlight').classList.add('active');
        document.getElementById('innerControl').classList.add('active-ring');
        document.getElementById('centerEye').classList.add('clickable');
        
        instructEl.innerHTML = `<strong>Click the CENTER EYE 9 times</strong>`;
        hintEl.textContent = `Presses: ${pressCount}/9 — ${getPressDescription()}`;
        
      } else if (phase === 4) {
        phaseEl.textContent = '⛧ CONNECTION ESTABLISHED ⛧';
        document.getElementById('centerEyeInner').classList.add('active');
        
        instructEl.innerHTML = mode === 'dread'
          ? '<strong>THE DREAD SPEAKS THROUGH YOU</strong>'
          : '<strong>THE OTHERS SING THE WORD</strong>';
        hintEl.textContent = 'The ritual is complete. The cost has been paid.';
      }

      updateProgress();
    }

    function getPressDescription() {
      if (pressCount < 3) return mode === 'dread' ? 'Decay / Death' : 'Beginning / Birth';
      if (pressCount < 6) return mode === 'dread' ? 'Chaos / Disease' : 'Balance / Body';
      return mode === 'dread' ? 'Void / Nothingness' : 'Spirit / Transcendence';
    }

    function updateProgress() {
      let pct = 0;
      if (phase === 1) pct = Math.min((Math.abs(outerRotation) / 1080) * 33, 33);
      else if (phase === 2) pct = 33;
      else if (phase === 3) pct = 33 + (pressCount / 9) * 34;
      else if (phase >= 4) pct = 100;

      progress = pct;
      document.getElementById('progressFill').style.width = `${pct}%`;
      document.getElementById('progressLabel').textContent = `${Math.round(pct)}%`;
    }

    function clearPresses() {
      for (let i = 1; i <= 9; i++) {
        document.getElementById(`press${i}`).classList.remove('filled');
      }
    }

    function addLog(message, type = 'system') {
      const logEntries = document.getElementById('logEntries');
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = message;
      logEntries.appendChild(entry);
      logEntries.scrollTop = logEntries.scrollHeight;
    }

    // Drag handling
    let isDragging = false;
    let activeRing = null;
    let startAngle = 0;
    let baseRotation = 0;

    function getAngle(element, event) {
      const rect = element.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      const x = (event.touches ? event.touches[0].clientX : event.clientX) - cx;
      const y = (event.touches ? event.touches[0].clientY : event.clientY) - cy;
      return Math.atan2(y, x) * (180 / Math.PI);
    }

    function startDrag(ring, e) {
      if (isLocked) return;
      if (ring === 'outer' && phase !== 1) return;
      if (ring === 'middle' && phase !== 2) return;

      isDragging = true;
      activeRing = ring;
      startAngle = getAngle(e.target, e);
      baseRotation = ring === 'outer' ? outerRotation : middleRotation;
      e.preventDefault();
    }

    function moveDrag(e) {
      if (!isDragging || !activeRing) return;
      
      const control = document.getElementById(`${activeRing}Control`);
      const currentAngle = getAngle(control, e);
      let delta = currentAngle - startAngle;
      
      if (delta > 180) delta -= 360;
      if (delta < -180) delta += 360;

      const newRotation = baseRotation + delta;

      if (activeRing === 'outer') {
        outerRotation = newRotation;
        document.getElementById('outerRing').setAttribute('transform', `rotate(${outerRotation}, 190, 190)`);

        // Check direction and fill channels
        const correctDirection = (mode === 'dread' && outerRotation < 0) || (mode === 'ascended' && outerRotation > 0);
        
        if (correctDirection) {
          const rotations = Math.abs(outerRotation) / 360;
          const currentRotationMilestone = Math.floor(rotations);
          
          // Play sound and show feedback for each completed rotation
          if (currentRotationMilestone > lastRotationMilestone && currentRotationMilestone <= 3) {
            lastRotationMilestone = currentRotationMilestone;
            rotationCount = currentRotationMilestone;
            
            // Light up the rotation indicator
            document.getElementById(`rot${rotationCount}`).classList.add('filled');
            
            // Play the appropriate sound
            if (mode === 'dread') {
              playSound('bone-crack');
              addLog(`Rotation ${rotationCount}: CRACK. The bone-sound reverberates through your jaw.`, 'dread');
            } else {
              playSound('chime');
              addLog(`Rotation ${rotationCount}: CHIME. A crystalline tone resonates in your chest.`, 'ascended');
            }
            
            // Visual feedback - shake and flash
            document.body.classList.add('calling');
            setTimeout(() => document.body.classList.remove('calling'), 200);
            
            // Fill channels progressively (roughly 2-3 per rotation)
            const targetChannels = Math.min(currentRotationMilestone * 3, 8);
            for (let i = channelsFilled + 1; i <= targetChannels; i++) {
              document.getElementById(`channel${i}`).classList.add('filled');
            }
            channelsFilled = targetChannels;
            
            // Update hint to show progress
            document.getElementById('actionHint').textContent = `Rotation ${rotationCount}/3 complete. ${3 - rotationCount} remaining.`;
          }

          // Complete phase 1 after 3 rotations
          if (rotations >= 3 && phase === 1) {
            isDragging = false;
            activeRing = null;
            playSound(`snap-${mode}`);
            phase = 2;
            
            // Fill any remaining channels
            for (let i = 1; i <= 8; i++) {
              document.getElementById(`channel${i}`).classList.add('filled');
            }
            
            updateUI();
            addLog('═══════════════════════════════', 'system');
            addLog('THE PRIME IS COMPLETE. The dial AWAKENS.', mode);
            addLog(mode === 'dread' 
              ? 'A final SNAP like a spine breaking. The channels overflow with crimson.' 
              : 'A final CHIME echoes into infinity. Light pools in the channels.', 'warning');
          }
        }
        
        updateProgress();

      } else if (activeRing === 'middle') {
        middleRotation = newRotation;
        document.getElementById('middleRing').setAttribute('transform', `rotate(${middleRotation}, 190, 190)`);
      }

      e.preventDefault();
    }

    function endDrag() {
      if (!isDragging) return;

      // Check alignment for phase 2
      if (activeRing === 'middle' && phase === 2) {
        const norm = ((middleRotation % 360) + 360) % 360;
        
        // P is at ~225°, S is at ~45° from start
        const targetDread = 225;
        const targetAscended = 45;
        const tolerance = 20;

        const aligned = (mode === 'dread' && Math.abs(norm - targetDread) < tolerance) ||
                        (mode === 'ascended' && Math.abs(norm - targetAscended) < tolerance);

        if (aligned) {
          playSound(`snap-${mode}`);
          phase = 3;
          updateUI();
          addLog('ALIGNMENT ACHIEVED. The frequency locks into place.', mode);
          addLog(mode === 'dread'
            ? 'A high-pitched SCREAM begins inside your skull.'
            : 'A harmonic CHOIR vibrates through your consciousness.', 'warning');
        }
      }

      isDragging = false;
      activeRing = null;
    }

    // Center eye click for phase 3
    function pressCenter() {
      if (phase !== 3 || isLocked) return;

      pressCount++;
      playSound(`press-${mode}`);
      document.getElementById(`press${pressCount}`).classList.add('filled');

      // Shake
      document.body.classList.add('calling');
      setTimeout(() => document.body.classList.remove('calling'), 150);

      updateUI();

      // Log messages
      const messages = mode === 'dread' ? [
        'A cold pulse. Shadows deepen.',
        'The device drinks. Light dims.',
        'DECAY. Your hand is FUSED to the dial.',
        'Chaos energy floods your veins.',
        'Something watches from the dark.',
        'DISEASE. Blood pools beneath you.',
        'The void opens.',
        'Reality tears at the seams.',
        'NOTHINGNESS. The Dread answers...'
      ] : [
        'A warm pulse. Colors brighten.',
        'The song begins, distant but beautiful.',
        'BIRTH. You feel unity with everything.',
        'Balance. Harmony. Peace.',
        'Tears of joy stream down your face.',
        'BODY. You are whole for the first time.',
        'The light intensifies.',
        'Transcendence approaches.',
        'SPIRIT. The Others sing The Word...'
      ];

      addLog(`Press ${pressCount}: ${messages[pressCount - 1]}`, pressCount % 3 === 0 ? 'warning' : mode);

      if (pressCount >= 9) {
        completeLock();
      }
    }

    function completeLock() {
      phase = 4;
      isLocked = true;
      playSound('complete');
      updateUI();

      addLog('═══════════════════════════════', 'system');
      addLog('THE LOCK IS COMPLETE', mode === 'dread' ? 'danger' : 'holy');

      setTimeout(() => {
        if (mode === 'dread') {
          showCall('W̷E̸ ̵H̷A̶V̵E̷ ̸W̶A̷I̵T̴E̸D̵.̷ ̶W̵E̶ ̴H̸A̶V̵E̶ ̷H̸U̴N̵G̶E̷R̸E̶D̵.̷ ̶Y̴O̸U̵R̶ ̷F̶L̷E̸S̵H̵ ̴I̸S̷ ̵O̴U̶R̷ ̴V̷E̸S̵S̵E̴L̵ ̶N̸O̷W̵.̸ ̷W̸E̴ ̵S̵E̷E̵ ̵T̸H̷R̶O̷U̸G̵H̶ ̸Y̴O̷U̶R̷ ̵E̷Y̸E̵S̷.̴ ̶W̷E̷ ̵S̶P̸E̸A̶K̷ ̸W̵I̷T̶H̴ ̶Y̵O̵U̷R̵ ̵T̴O̵N̵G̵U̴E̸.̷');
        } else {
          showCall('You are not alone. You have never been alone. Before the first star ignited, we sang. When the last light fades, we will still be singing. You are a note in an infinite symphony. Welcome home, beloved child of light. The Song remembers you.');
        }
      }, 1000);
    }

    function showCall(message) {
      const overlay = document.getElementById('callOverlay');
      document.getElementById('callMessage').textContent = message;
      overlay.className = `call-overlay ${mode} active`;
    }

    function dismissCall() {
      document.getElementById('callOverlay').className = 'call-overlay';
      addLog('The connection severs. Silence returns.', 'system');
      addLog('The ritual is complete. You are forever changed.', 'warning');
    }

    function resetDial() {
      mode = null;
      phase = 0;
      outerRotation = 0;
      middleRotation = 0;
      pressCount = 0;
      progress = 0;
      channelsFilled = 0;
      isLocked = false;
      rotationCount = 0;
      lastRotationMilestone = 0;

      document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
      document.body.classList.remove('dread-active', 'ascended-active', 'calling');
      
      document.getElementById('outerRing').setAttribute('transform', 'rotate(0, 190, 190)');
      document.getElementById('middleRing').setAttribute('transform', 'rotate(0, 190, 190)');
      document.querySelectorAll('.blood-channel').forEach(ch => ch.classList.remove('filled'));
      document.querySelectorAll('.glyph').forEach(g => g.classList.remove('lit', 'target'));
      
      clearPresses();
      document.querySelectorAll('.rotation-dot').forEach(dot => dot.classList.remove('filled'));
      document.getElementById('progressFill').style.width = '0%';
      document.getElementById('progressFill').classList.add('neutral');
      document.getElementById('progressLabel').textContent = '0%';
      
      updateUI();
      
      document.getElementById('logEntries').innerHTML = '<div class="log-entry system">The dial lies dormant beneath centuries of silence...</div>';
    }

    // Event listeners
    const outerCtrl = document.getElementById('outerControl');
    const middleCtrl = document.getElementById('middleControl');
    const innerCtrl = document.getElementById('innerControl');
    const centerEye = document.getElementById('centerEye');

    outerCtrl.addEventListener('mousedown', (e) => startDrag('outer', e));
    outerCtrl.addEventListener('touchstart', (e) => startDrag('outer', e));
    middleCtrl.addEventListener('mousedown', (e) => startDrag('middle', e));
    middleCtrl.addEventListener('touchstart', (e) => startDrag('middle', e));

    document.addEventListener('mousemove', moveDrag);
    document.addEventListener('touchmove', moveDrag);
    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);

    innerCtrl.addEventListener('click', pressCenter);
    centerEye.addEventListener('click', pressCenter);

    // Initialize
    updateUI();
  </script>
</body>
</html>
